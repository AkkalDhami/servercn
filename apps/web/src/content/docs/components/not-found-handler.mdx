---
title: Not Found Handler
description: The Not Found Handler component provides a centralized and consistent way to handle **unmatched routes**.

command: npx servercn-cli add not-found-handler

mvc_structure:
  - type: folder
    name: src
    children:
      - type: folder
        name: configs
        children:
          - type: file
            name: env.ts
            content: |
              interface Config {
                PORT: number;
                NODE_ENV: string;
                LOG_LEVEL: string;
              }

              const env: Config = {
                PORT: Number(process.env.PORT) || 3000,
                NODE_ENV: process.env.NODE_ENV || 'development',
                LOG_LEVEL: process.env.LOG_LEVEL || 'info',
              };

              export default env;

      - type: folder
        name: constants
        children:
          - type: file
            name: status-codes.ts
            content: |
              export const STATUS_CODES = {
              // 2xx Success
              OK: 200,
              CREATED: 201,
              ACCEPTED: 202,
              NO_CONTENT: 204,

              // 3xx Redirection
              MOVED_PERMANENTLY: 301,
              FOUND: 302,
              NOT_MODIFIED: 304,

              // 4xx Client Errors
              BAD_REQUEST: 400,
              UNAUTHORIZED: 401,
              FORBIDDEN: 403,
              NOT_FOUND: 404,
              CONFLICT: 409,
              UNPROCESSABLE_ENTITY: 422,
              TOO_MANY_REQUESTS: 429,

              // 5xx Server Errors
              INTERNAL_SERVER_ERROR: 500,
              NOT_IMPLEMENTED: 501,
              BAD_GATEWAY: 502,
              SERVICE_UNAVAILABLE: 503,
              GATEWAY_TIMEOUT: 504,
              } as const;

              export type StatusCode = (typeof STATUS_CODES)[keyof typeof STATUS_CODES];

      - type: folder
        name: middlewares
        children:
          - type: file
            name: error-handler.ts
            content: |
              import { Request, Response, NextFunction } from "express";
              import env from "../configs/env";

              import { ApiError } from "../utils/api-error";
              import { logger } from "../utils/logger";

              export const errorHandler = (
                err: Error,
                req: Request,
                res: Response,
                next: NextFunction
              ) => {
                let statusCode = 500;
                let message = "Internal server error";

                if (err instanceof ApiError) {
                  statusCode = err.statusCode;
                  message = err.message;
                }

                logger.error(
                 `Error: ${message} | Status: ${statusCode} | Path: ${req.method} ${req.originalUrl}`,
                  err
                );

                const response = {
                  success: false,
                  message,
                  ...(env.NODE_ENV === "development" && { stack: err.stack }),
                };

                res.status(statusCode).json(response);
              };
          - type: file
            name: not-found-handler.ts
            content: |
              import { Request, Response, NextFunction } from "express";
              import { ApiError } from "../utils/api-error";

              export const notFoundHandler = (
                req: Request,
                res: Response,
                next: NextFunction
              ) => {
                throw ApiError.notFound(`Route ${req.method} ${req.originalUrl} not found`);
              };

      - type: folder
        name: utils
        children:
          - type: file
            name: api-error.ts
            content: |
              import { STATUS_CODES, StatusCode } from "../constants/status-codes";

              export class ApiError extends Error {
              public readonly statusCode: StatusCode;
              public readonly isOperational: boolean;
              public readonly errors?: unknown;

              constructor(
                  statusCode: StatusCode,
                  message: string,
                  errors?: unknown,
                  isOperational = true
              ) {
                  super(message);
                  this.name = "ApiError";
                  this.statusCode = statusCode;
                  this.errors = errors;
                  this.isOperational = isOperational;

                  Error.captureStackTrace(this, this.constructor);
              }

              static badRequest(message = "Bad Request", errors?: unknown) {
                  return new ApiError(STATUS_CODES.BAD_REQUEST, message, errors);
              }

              static unauthorized(message = "Unauthorized") {
                  return new ApiError(STATUS_CODES.UNAUTHORIZED, message);
              }

              static forbidden(message = "Forbidden") {
                  return new ApiError(STATUS_CODES.FORBIDDEN, message);
              }

              static notFound(message = "Not Found") {
                  return new ApiError(STATUS_CODES.NOT_FOUND, message);
              }

              static conflict(message = "Conflict") {
                  return new ApiError(STATUS_CODES.CONFLICT, message);
              }

              static server(message = "Internal Server Error") {
                  return new ApiError(STATUS_CODES.INTERNAL_SERVER_ERROR, message);
              }
              }

              /*
              ? Usage:
              * throw new ApiError(STATUS_CODES.NOT_FOUND, "Not found");
              * throw ApiError.badRequest("Bad request");
              */
          - type: file
            name: logger.ts
            content: |
              import env from "../configs/env";
              import winston from "winston";
              import DailyRotateFile from "winston-daily-rotate-file";

              const { combine, timestamp, printf, colorize, errors } = winston.format;

              const logFormat = printf(({ level, message, timestamp, stack }) => {
                return `${timestamp} [${level}] : ${stack || message}`;
              });

              const transports: winston.transport[] = [];

              if (env.NODE_ENV !== "production") {
                transports.push(
                  new winston.transports.Console({
                    format: combine(
                      colorize(),
                      timestamp({ format: "YYYY-MM-DD HH:mm:ss" }),
                      errors({ stack: true }),
                      logFormat
                    ),
                  })
                );
              }

              if (env.NODE_ENV !== "development") {
                transports.push(
                  new DailyRotateFile({
                    dirname: "logs/app",
                    filename: "app-%DATE%.log",
                    datePattern: "YYYY-MM-DD",
                    zippedArchive: true,
                    maxSize: "20m",
                    maxFiles: "14d",
                    level: "info",
                  })
                );
                transports.push(
                  new DailyRotateFile({
                    dirname: "logs/error",
                    filename: "errors-%DATE%.log",
                    datePattern: "YYYY-MM-DD",
                    zippedArchive: true,
                    maxSize: "20m",
                    maxFiles: "30d",
                    level: "error",
                  })
                );
              }

              export const logger = winston.createLogger({
                level: env.LOG_LEVEL,
                format: combine(
                  timestamp({ format: "YYYY-MM-DD HH:mm:ss" }),
                  errors({ stack: true }),
                  logFormat
                ),
                transports,
                exitOnError: false,
              });

      - type: file
        name: app.ts
        content: |
          import express, { type Application } from "express";
          import "dotenv/config";
          import { errorHandler } from "./middlewares/error-handler";
          import { notFoundHandler } from "./middlewares/not-found-handler";


          const app: Application = express();

          app.use(express.json());

          // routes here
          // ...

          // Not found handler (should be after routes)
          app.use(notFoundHandler);

          // Global error handler (should be last)
          app.use(errorHandler);

          export default app;

  - type: file
    name: .env.example
    content: |

      PORT='3000'
      NODE_ENV='development'
      LOG_LEVEL='info'

feature_structure:
  - type: folder
    name: src
    children:
      - type: folder
        name: shared
        children:
          - type: folder
            name: configs
            children:
              - type: file
                name: env.ts
                content: |
                  interface Config {
                    PORT: number;
                    NODE_ENV: string;
                    LOG_LEVEL: string;
                  }

                  const config: Config = {
                    PORT: Number(process.env.PORT) || 3000,
                    NODE_ENV: process.env.NODE_ENV || 'development',
                    LOG_LEVEL: process.env.LOG_LEVEL || 'info',
                  };

                  export default config;

          - type: folder
            name: constants
            children:
              - type: file
                name: status-codes.ts
                content: |
                  export const STATUS_CODES = {
                  // 2xx Success
                  OK: 200,
                  CREATED: 201,
                  ACCEPTED: 202,
                  NO_CONTENT: 204,

                  // 3xx Redirection
                  MOVED_PERMANENTLY: 301,
                  FOUND: 302,
                  NOT_MODIFIED: 304,

                  // 4xx Client Errors
                  BAD_REQUEST: 400,
                  UNAUTHORIZED: 401,
                  FORBIDDEN: 403,
                  NOT_FOUND: 404,
                  CONFLICT: 409,
                  UNPROCESSABLE_ENTITY: 422,
                  TOO_MANY_REQUESTS: 429,

                  // 5xx Server Errors
                  INTERNAL_SERVER_ERROR: 500,
                  NOT_IMPLEMENTED: 501,
                  BAD_GATEWAY: 502,
                  SERVICE_UNAVAILABLE: 503,
                  GATEWAY_TIMEOUT: 504,
                  } as const;

                  export type StatusCode = (typeof STATUS_CODES)[keyof typeof STATUS_CODES];

          - type: folder
            name: errors
            children:
              - type: file
                name: api-error.ts
                content: |
                  import { STATUS_CODES, StatusCode } from "../constants/status-codes";

                  export class ApiError extends Error {
                  public readonly statusCode: StatusCode;
                  public readonly isOperational: boolean;
                  public readonly errors?: unknown;

                  constructor(
                      statusCode: StatusCode,
                      message: string,
                      errors?: unknown,
                      isOperational = true
                  ) {
                      super(message);
                      this.name = "ApiError";
                      this.statusCode = statusCode;
                      this.errors = errors;
                      this.isOperational = isOperational;

                      Error.captureStackTrace(this, this.constructor);
                  }

                  static badRequest(message = "Bad Request", errors?: unknown) {
                      return new ApiError(STATUS_CODES.BAD_REQUEST, message, errors);
                  }

                  static unauthorized(message = "Unauthorized") {
                      return new ApiError(STATUS_CODES.UNAUTHORIZED, message);
                  }

                  static forbidden(message = "Forbidden") {
                      return new ApiError(STATUS_CODES.FORBIDDEN, message);
                  }

                  static notFound(message = "Not Found") {
                      return new ApiError(STATUS_CODES.NOT_FOUND, message);
                  }

                  static conflict(message = "Conflict") {
                      return new ApiError(STATUS_CODES.CONFLICT, message);
                  }

                  static server(message = "Internal Server Error") {
                      return new ApiError(STATUS_CODES.INTERNAL_SERVER_ERROR, message);
                  }
                  }

                  /*
                  ? Usage:
                  * throw new ApiError(STATUS_CODES.NOT_FOUND, "Not found");
                  * throw ApiError.badRequest("Bad request");
                  */

          - type: folder
            name: utils
            children:
              - type: file
                name: logger.ts
                content: |
                  import env from "../configs/env";
                  import winston from "winston";
                  import DailyRotateFile from "winston-daily-rotate-file";

                  const { combine, timestamp, printf, colorize, errors } = winston.format;

                  const logFormat = printf(({ level, message, timestamp, stack }) => {
                    return `${timestamp} [${level}] : ${stack || message}`;
                  });

                  const transports: winston.transport[] = [];

                  if (env.NODE_ENV !== "production") {
                    transports.push(
                      new winston.transports.Console({
                        format: combine(
                          colorize(),
                          timestamp({ format: "YYYY-MM-DD HH:mm:ss" }),
                          errors({ stack: true }),
                          logFormat
                        ),
                      })
                    );
                  }

                  if (env.NODE_ENV !== "development") {
                    transports.push(
                      new DailyRotateFile({
                        dirname: "logs/app",
                        filename: "app-%DATE%.log",
                        datePattern: "YYYY-MM-DD",
                        zippedArchive: true,
                        maxSize: "20m",
                        maxFiles: "14d",
                        level: "info",
                      })
                    );
                    transports.push(
                      new DailyRotateFile({
                        dirname: "logs/error",
                        filename: "errors-%DATE%.log",
                        datePattern: "YYYY-MM-DD",
                        zippedArchive: true,
                        maxSize: "20m",
                        maxFiles: "30d",
                        level: "error",
                      })
                    );
                  }

                  export const logger = winston.createLogger({
                    level: env.LOG_LEVEL,
                    format: combine(
                      timestamp({ format: "YYYY-MM-DD HH:mm:ss" }),
                      errors({ stack: true }),
                      logFormat
                    ),
                    transports,
                    exitOnError: false,
                  });

          - type: folder
            name: middlewares
            children:
              - type: file
                name: error-handler.ts
                content: |
                  import { Request, Response, NextFunction } from "express";
                  import env from "../configs/env";

                  import { ApiError } from "../errors/api-error";
                  import { logger } from "../utils/logger";

                  export const errorHandler = (
                    err: Error,
                    req: Request,
                    res: Response,
                    next: NextFunction
                  ) => {
                    let statusCode = 500;
                    let message = "Internal server error";

                    if (err instanceof ApiError) {
                      statusCode = err.statusCode;
                      message = err.message;
                    }

                    logger.error(
                    `Error: ${message} | Status: ${statusCode} | Path: ${req.method} ${req.originalUrl}`,
                      err
                    );

                    const response = {
                      success: false,
                      message,
                      ...(env.NODE_ENV === "development" && { stack: err.stack }),
                    };

                    res.status(statusCode).json(response);
                  };

              - type: file
                name: not-found-handler.ts
                content: |
                  import { Request, Response, NextFunction } from "express";
                  import { ApiError } from "../errors/api-error";

                  export const notFoundHandler = (
                    req: Request,
                    res: Response,
                    next: NextFunction
                  ) => {
                    throw ApiError.notFound(`Route ${req.method} ${req.originalUrl} not found`);
                  };

      - type: file
        name: app.ts
        content: |
          import express, { type Application } from "express";
          import "dotenv/config";
          import { errorHandler } from "./shared/middlewares/error-handler";
          import { notFoundHandler } from "./shared/middlewares/not-found-handler";

          const app: Application = express();

          app.use(express.json());

          // routes here
          // ...

          // Not found handler (should be after routes)
          app.use(notFoundHandler);

          // Global error handler (should be last)
          app.use(errorHandler);

          export default app;

  - type: file
    name: .env.example
    content: |

      PORT='3000'
      NODE_ENV='development'
      LOG_LEVEL='info'
---

# Not Found Handler

The Not Found Handler component provides a centralized and consistent way to handle **unmatched routes**.

Instead of allowing undefined routes to return inconsistent responses or default Express errors, this component ensures that all unknown endpoints respond with a standardized 404 Not Found error.

This component exists to:

- Catch all requests to undefined routes
- Return a predictable and structured 404 response
- Integrate seamlessly with ServerCN error handling
- Improve API reliability and developer experience

## Installation Guide

This component requires additional ServerCN components.

**_üëâ Note:_** _You do not need to install any servercn dependencies manually. Installing this component will automatically install all required servercn dependencies. Manual installation is optional if you prefer to manage dependencies yourself._

### 1. Install ServerCN components(Optional)

- **API Error Handler:**

<PackageManagerTabs command="npx servercn-cli add error-handler" />

Documentation: [API Error Handler](/docs/components/error-handler)

> ‚ö†Ô∏è If this dependency is not installed, the component will not function correctly.

### 2. Install this component

<PackageManagerTabs command="npx servercn-cli add not-found-handler" />

This component requires the **API Error Handler** component to function correctly.

## Basic Implementation

The Not Found Handler is a middleware that catches all unmatched routes and throws a standardized 404 error.

### 1. MVC Structure

<Code children="src/middlewares/not-found-handler.ts" />

```ts
import { Request, Response, NextFunction } from "express";
import { ApiError } from "../utils/api-error";

export const notFoundHandler = (
  req: Request,
  res: Response,
  next: NextFunction
) => {
  throw ApiError.notFound(`Route ${req.method} ${req.originalUrl} not found`);
};
```

### 2. Feature Structure

<Code children="src/shared/middlewares/not-found-handler.ts" />

```ts
import { Request, Response, NextFunction } from "express";
import { ApiError } from "../errors/api-error";

export const notFoundHandler = (
  req: Request,
  res: Response,
  next: NextFunction
) => {
  throw ApiError.notFound(`Route ${req.method} ${req.originalUrl} not found`);
};
```

## Usage Example

The Not Found Handler must be placed **after all routes** but **before the error handler** in your Express application.

### 1. MVC Structure

<Code children="src/app.ts" />

```ts
import express, { type Application } from "express";
import "dotenv/config";
import { errorHandler } from "./middlewares/error-handler";
import { notFoundHandler } from "./middlewares/not-found-handler";

const app: Application = express();

app.use(express.json());

// routes here
// ...

// Not found handler (should be after routes)
app.use(notFoundHandler);

// Global error handler (should be last)
app.use(errorHandler);

export default app;
```

### 2. Feature Structure

<Code children="src/app.ts" />

```ts
import express, { type Application } from "express";
import "dotenv/config";
import { errorHandler } from "./shared/middlewares/error-handler";
import { notFoundHandler } from "./shared/middlewares/not-found-handler";

const app: Application = express();

app.use(express.json());

// routes here
// ...

// Not found handler (should be after routes)
app.use(notFoundHandler);

// Global error handler (should be last)
app.use(errorHandler);

export default app;
```

## Response Format

When a route is not found, the handler returns a standardized 404 response:

```json
{
  "success": false,
  "message": "Route GET /api/v1/invalid-route not found",
  "statusCode": 404
}
```

The exact format depends on your <Code children='ApiError' /> and <Code children='ApiResponse' /> configuration.

## How It Works

1. **Route Matching**: Express processes routes in the order they are defined
2. **Catch-All**: The Not Found Handler is placed after all defined routes
3. **Error Throwing**: When a request doesn't match any route, it reaches the Not Found Handler
4. **Error Propagation**: The handler throws an <Code children='ApiError' /> with a 404 status code
5. **Error Handling**: The global error handler catches the error and returns a standardized response

## Best Practices

- Use <Code children="ApiError.notFound()" /> for consistency
- Always place the Not Found Handler **after** all route definitions
- Always place the Not Found Handler **before** the global error handler
- The handler will catch all HTTP methods (GET, POST, PUT, DELETE, etc.)
- Customize the error message to include the method and path for better debugging

## Why This Component Matters

**Without a dedicated not found handler:**

- Undefined routes may return HTML error pages
- Error responses become inconsistent
- Debugging API issues becomes harder

**This component ensures:**

- All API endpoints return JSON
- Status codes are correct and explicit
- Errors are handled uniformly
